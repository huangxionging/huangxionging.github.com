<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.2.1 (452715)"/><meta name="created" content="2014-08-10 04:35:36 +0000"/><meta name="source" content="Clearly"/><meta name="source-url" content="http://www.raywenderlich.com/553/xml-tutorial-for-ios-how-to-choose-the-best-xml-parser-for-your-iphone-project"/><meta name="updated" content="2014-08-10 04:35:36 +0000"/><title>XML Tutorial for iOS: The Best XML Parser for Your iPhone Project</title></head><body><div><div><div><h1>The Best XML Parser for Your iPhone Project</h1></div>
								
					
					
						<div><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparserlist" target="_blank"/><div><img src="XML%20Tutorial%20for%20iOS%3A%20The%20Best%20XML%20Parser%20for%20Your%20iPhone%20Project.resources/7F283FF4-4F6F-429B-A80D-60FE1EE29BB7.jpg" height="375" width="250"/></div><p>XMLPerformance Test App Extended To Compare 3rd Party Libraries</p></div>
<p>There are a lot of options when it comes to parsing XML on the iPhone.  The iPhone SDK comes with two different libraries to choose from, and there are several popular third party libraries available such as TBXML, TouchXML, KissXML, TinyXML, and GDataXML.  How is a developer to choose the best XML parser for their project?</p>
<p>I have been recently taking a look at the various options out there, and ended up extending the XMLPerformance sample from Apple to try out each of the above libraries to learn how they worked and compare their performance.  I thought I’d share what I’ve learned thus far to others who might be searching for the best XML library for their iPhone project.</p>
<p>In this XML tutorial we’ll give a detailed comparison of the features and performance of the most popular iPhone libraries, explain how to choose between them, and give a sample project showing how to read XML data using each of the above libraries.</p>
<h2>SAX vs. DOM</h2>
<p>Before we begin, I wanted to make sure everyone is aware of the most important difference between XML parsers: whether the parser is a SAX or a DOM parser.</p>
<ul><li>A <em>SAX parser</em> is one where your code is notified as the parser walks through the XML tree, and you are responsible for keeping track of state and constructing any objects you might want to keep track of the data as the parser marches through.</li><li>A <em>A DOM parser</em> reads the entire document and builds up an in-memory representation that you can query for different elements.  Often, you can even construct XPath queries to pull out particular pieces.</li></ul>
<p>Ok, now let’s discuss some of the libraries!</p>
<h2>The Most Popular XML Parsers for the iPhone</h2>
<p>In my research, here’s what seemed to me to be the most popular XML Parsers for the iPhone, and a brief description of each one:</p>
<ul><li><a shape="rect" href="http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html" target="_blank">NSXMLParser</a> is a SAX parser included by default with the iPhone SDK.  It’s written in Objective-C and is quite straightforward to use, but perhaps not quite as easy as the DOM model.</li><li><a shape="rect" href="http://xmlsoft.org/" target="_blank">libxml2</a> is an Open Source library that is included by default with the iPhone SDK.  It is a C-based API, so is a bit more work to use than NSXML.  The library supports both DOM and SAX processing.  The libxml2 SAX processor is especially cool, as it has a unique feature of being able to parse the data as it’s being read.  For example, you could be reading a large XML document from the network and displaying data that you’re reading for it to the user while you’re still downloading.</li><li><a shape="rect" href="http://www.tbxml.co.uk/" target="_blank">TBXML</a> is a lightweight DOM XML parser designed to be as quick as possible while consuming few memory resources.  It saves time by not performing validation, not supporting XPath, and by being read-only – i.e. you can read XML with it, but you can’t then modify the XML and write it back out again.</li><li><a shape="rect" href="https://github.com/TouchCode/TouchXML" target="_blank">TouchXML</a> is an NSXML style DOM XML parser for the iPhone.  Like TBXML, it is also read-only, but unlike TBXML it does support XPath.</li><li><a shape="rect" href="http://code.google.com/p/kissxml" target="_blank">KissXML</a> is another NSSXML style DOM XML parser for the iPhone, actually based on TouchXML.  The main difference is KissXML also supports editing and writing XML as well as reading.</li><li><a shape="rect" href="http://www.grinninglizard.com/tinyxml/" target="_blank">TinyXML</a> is a small C-based DOM XML parser that consists of just four C files and two headers.  It supports both reading and writing XML documents, but it does not support XPath on its own.  However, you can use a related library – TinyXPath – for that.</li><li><a shape="rect" href="http://code.google.com/p/gdata-objectivec-client/source/browse/trunk/Source/XMLSupport/" target="_blank">GDataXML</a> is yet another NSXML style DOM XML parser for the iPhone, developed by Google as part of their Objective-C client library.  Consisting of just a M file and a header, it supports both reading and writing XML documents and XPath queries.</li></ul>
<p>Ok, now let’s start comparing all these libraries!</p>
<h2>XML Parser Performance Comparison App</h2>
<p><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparserstats" target="_blank"/></p><div><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparserstats" target="_blank"><img src="XML%20Tutorial%20for%20iOS%3A%20The%20Best%20XML%20Parser%20for%20Your%20iPhone%20Project.resources/B2FCCBA5-7D73-4C81-B783-8EE59875BB73.jpg" height="480" width="320"/></a></div><p/>
<p>Apple has made an excellent code sample called XMLPerformance that allows you to compare the time it takes to parse a ~900KB XML document containing the top 300 iTunes songs with both the NSXML and libxml2 APIs.  </p>
<p>The sample allows you to choose a parsing method and then parse the document, and it keeps statistics on how long it took to download the file and parse the file in a database.  You can then go to a statistics screen to see the average download and parse times for each method. </p>
<p>I thought this would be an ideal way to test out how these various APIs performed against each other, so I extended the sample to include all of the above libraries.  You can download the updated project below if you want to try it out on your device.  It also serves as a nice example of how to use each of the above APIs!</p>
<p><a shape="rect" href="http://d1xzuxjlafny7l.cloudfront.net/downloads/XMLPerformance.zip" target="_blank">Download Updated XMLPerformance Project</a></p>
<p>A note on the project: if the library included XPath support, I used it for a single lookup, because I felt it represented the way the library would be used in practice.  But of course XPath is generally slower than manually walking through the tree, so it adds to the benchmarks for those libraries.</p>
<p>So anyway – I’ll discuss the results of how things performed on my device here with the sample written as-is – but feel free to give it a shot on your device, or tweak the code based on the actual XML data you need to parse!</p>
<h2>XML Parser Performance Comparison</h2>
<p>Here’s some graphs that shows how quickly the various parsers parsed the XML document on my device (an iPhone 3Gs):</p>
<p><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparserspeed" target="_blank"/></p><div><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparserspeed" target="_blank"><img src="XML%20Tutorial%20for%20iOS%3A%20The%20Best%20XML%20Parser%20for%20Your%20iPhone%20Project.resources/683D54C4-21B8-44E3-B48C-2B07406C797D.jpg" height="270" width="617"/></a></div><p/>
<p>As you can see here, NSXMLParser was the slowest method by far.  TBXML was the fastest, which makes sense because many features were taken out in order to optimize parse time for reading only.</p>
<p>I was surprised, however, to see that TBXML and some of the other DOM parsing methods performed faster than libxml2′s SAX parser, which I had thought would be the fastest of all of the methods.  I haven’t profiled it, but my guess as to why it is slower is because of the frequent string compares needed to parse the document in the SAX method.</p>
<p>However, don’t discount libxml2′s SAX method by looking at this chart.  Remember that libxml2 is the only one of these methods that can parse the document as it’s reading in – so it can let your app start displaying data right away rather than having to let the download finish first.</p>
<p>Ok, here’s a graph that shows the peak memory usage by parser (this was obtained through running the various methods through the Object Allocations tool):</p>
<p><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparsermemoryusage" target="_blank"/></p><div><a shape="rect" href="http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project/xmlparsermemoryusage" target="_blank"><img src="XML%20Tutorial%20for%20iOS%3A%20The%20Best%20XML%20Parser%20for%20Your%20iPhone%20Project.resources/2C31CEA8-34B2-4A5F-9E42-059CD3968932.jpg" height="283" width="614"/></a></div><p/>
<p>Note that the DOM methods usually require more memory overhead than the SAX methods (with the exception of TBXML, which is indeed quite efficient).  This is something to consider when you are dealing with especially large documents, given the memory constraints on an iPhone.</p>
<p>Also note that libxml2′s SAX method is the best option as far as peak memory usage is concerned (and I suspect it would scale better than the others as well).</p>
<p>Finally, let’s wrap up with a chart that summarizes the differences between the parsers and everything we’ve discussed above:</p>
<table><tr><th colspan="1" rowspan="1">NSXML</th><th colspan="1" rowspan="1">libxml2 – SAX</th><th colspan="1" rowspan="1">TBXML</th><th colspan="1" rowspan="1">TouchXML</th><th colspan="1" rowspan="1">KissXML</th><th colspan="1" rowspan="1">TinyXML</th><th colspan="1" rowspan="1">GDataXML</th><th colspan="1" rowspan="1">libxml2 – DOM</th></tr><tr><td colspan="1" rowspan="1">Included with SDK?</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">Yes</td></tr><tr><td colspan="1" rowspan="1">Seconds to Parse</td><td colspan="1" rowspan="1">1.87</td><td colspan="1" rowspan="1">1.19</td><td colspan="1" rowspan="1">0.68</td><td colspan="1" rowspan="1">1.1</td><td colspan="1" rowspan="1">1.37</td><td colspan="1" rowspan="1">1.27</td><td colspan="1" rowspan="1">1.07</td><td colspan="1" rowspan="1">0.84</td></tr><tr><td colspan="1" rowspan="1">Peak Memory Usage</td><td colspan="1" rowspan="1">3.11</td><td colspan="1" rowspan="1">3.01</td><td colspan="1" rowspan="1">3.07</td><td colspan="1" rowspan="1">6.5</td><td colspan="1" rowspan="1">5.25</td><td colspan="1" rowspan="1">4.8</td><td colspan="1" rowspan="1">4.15</td><td colspan="1" rowspan="1">4.97</td></tr><tr><td colspan="1" rowspan="1">Parse While Downloading?</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td></tr><tr><td colspan="1" rowspan="1">Edit/Save XML?</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes</td></tr><tr><td colspan="1" rowspan="1">XPath Support?</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">No</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes*</td><td colspan="1" rowspan="1">Yes</td><td colspan="1" rowspan="1">Yes</td></tr><tr><td colspan="1" rowspan="1">C or Obj-C</td><td colspan="1" rowspan="1">Obj-C</td><td colspan="1" rowspan="1">C</td><td colspan="1" rowspan="1">Obj-C</td><td colspan="1" rowspan="1">Obj-C</td><td colspan="1" rowspan="1">Obj-C</td><td colspan="1" rowspan="1">C</td><td colspan="1" rowspan="1">Obj-C</td><td colspan="1" rowspan="1">C</td></tr><tr><td colspan="1" rowspan="1">License</td><td colspan="1" rowspan="1">Apple</td><td colspan="1" rowspan="1">MIT</td><td colspan="1" rowspan="1">MIT</td><td colspan="1" rowspan="1">MIT</td><td colspan="1" rowspan="1">MIT</td><td colspan="1" rowspan="1">ZLib</td><td colspan="1" rowspan="1">Apache</td><td colspan="1" rowspan="1">MIT</td></tr></table>
<p>* = with TinyXPath</p>
<h2>Which To Choose?</h2>
<p>Which XML parser to choose really depends on what you want to do with the parser.</p>
<ul><li>If you just want to <em>read small XML documents</em>, performance doesn’t matter as much with small documents.  You probably want to pick something with XPath support and something that is written in Objective-C to make your job easier.  So I’d recommend either TouchXML, KissXML, or GDataXML for this case.</li><li>If you want to both <em>read and write small XML documents</em>, again performance doesn’t matter as much as functionality and ease of use.  You probably want to pick something with XPath support, written in Objective-C, with read/write capability.  So I’d recommend KissXML or GDataXML for this case.</li><li>If you want to <em>read extremely large XML documents</em>, performance is the critical issue here.  You’ll want to consider libxml2 SAX, TBXML, or libxml DOM for this, depending on what your exact situation is.</li></ul>
<p>What about the ones I didn’t mention?</p>
<ul><li><em>NSXML</em> is a decent choice if you’re dealing with relatively small documents, and you don’t feel like adding a third party library to the SDK.</li><li><em>TinyXML</em> could be an OK choice for medium sized documents if you already have experience with the API and are comfortable with C as it ports quite easily over to the iPhone.</li></ul>
<p>I took a look at two other XML libraries during the course of this investigation (VTD-XML and Objective-XML), but I couldn’t get them working.  If someone else has had more luck with these, feel free to extend the sample project to include them!</p>
<h2>Where To Go From Here?</h2>
<p>If you’re looking for some help using one of these libraries, check out my post on <a shape="rect" href="http://www.raywenderlich.com/725/xml-tutorial-for-ios-how-to-read-and-write-xml-documents-with-gdataxml" target="_blank">How to Read and Write XML Documents with GDataXML</a>.</p>
<p>And if anyone has any additional feedback about these libraries or tips that may help other developers, please chime in below!</p>
	
					</div></div></body></html>